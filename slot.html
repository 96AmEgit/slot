<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ã‚¹ãƒˆãƒƒãƒ—ã‚¹ãƒ­ãƒƒãƒˆ</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            background-color: #f0f2f5;
            padding: 20px 0;
        }

        .container {
            background-color: #fff;
            padding: 20px 40px;
            border-radius: 15px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
            text-align: center;
            width: 380px;
        }

        h1 {
            color: #333;
            margin-top: 0;
        }
        
        /* --- ã‚²ãƒ¼ãƒ ç”»é¢ --- */
        #game-screen {
            display: block;
        }

        #reels-container {
            display: flex;
            justify-content: center;
            gap: 10px; /* ãƒªãƒ¼ãƒ«ã¨ãƒœã‚¿ãƒ³ã®é–“ã®éš™é–“ */
            margin: 20px 0;
        }

        .reel-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .reel {
            width: 80px;
            height: 80px;
            border: 5px solid #ddd;
            background: #fafafa;
            border-radius: 10px;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 60px;
        }

        .reel img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .stop-button {
            width: 80px;
            padding: 10px 0;
            font-size: 16px;
            font-weight: bold;
            color: white;
            background-color: #dc3545;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .stop-button:hover {
            background-color: #c82333;
        }
        .stop-button:disabled {
            background-color: #cccccc;
            color: #666666;
            cursor: not-allowed;
        }
        
        #player-info {
            font-size: 18px;
            color: #555;
            margin-bottom: 20px;
        }

        #player-info span {
            font-weight: bold;
            color: #e84118;
        }
        
        #bet-amount {
            width: 60px;
            padding: 5px;
            font-size: 16px;
            border-radius: 5px;
            border: 1px solid #ccc;
            text-align: center;
        }

        #spin-button {
            background-color: #4CAF50;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 20px;
            font-weight: bold;
            margin-top: 15px;
            transition: background-color 0.3s, transform 0.1s;
        }

        #spin-button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }

        #message {
            margin-top: 20px;
            font-size: 18px;
            font-weight: bold;
            color: #d35400;
            height: 25px;
        }
    </style>
</head>
<body>

<div class="container">
    <div id="game-screen">
        <h1>ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ã‚¹ãƒˆãƒƒãƒ—ã‚¹ãƒ­ãƒƒãƒˆ</h1>
        <div id="player-info">
            æ‰€æŒã‚³ã‚¤ãƒ³: <span id="coin-count">100</span>
        </div>

        <div id="reels-container">
            <div class="reel-wrapper">
                <div class="reel" id="reel1">ğŸ’</div>
                <button class="stop-button" id="stop1" disabled>ã‚¹ãƒˆãƒƒãƒ—</button>
            </div>
            <div class="reel-wrapper">
                <div class="reel" id="reel2">ğŸ’</div>
                <button class="stop-button" id="stop2" disabled>ã‚¹ãƒˆãƒƒãƒ—</button>
            </div>
            <div class="reel-wrapper">
                <div class="reel" id="reel3">ğŸ’</div>
                <button class="stop-button" id="stop3" disabled>ã‚¹ãƒˆãƒƒãƒ—</button>
            </div>
        </div>

        <div id="message">ãƒ™ãƒƒãƒˆã—ã¦ã‚¹ãƒ”ãƒ³ï¼</div>
        <div id="controls">
            <div>
                <label for="bet-amount">ãƒ™ãƒƒãƒˆé¡:</label>
                <input type="number" id="bet-amount" value="10" min="1">
            </div>
            <button id="spin-button">ã‚¹ãƒ”ãƒ³</button>
        </div>
    </div>
</div>

<script>
    // --- HTMLè¦ç´ ã®å–å¾— ---
    const reels = [document.getElementById('reel1'), document.getElementById('reel2'), document.getElementById('reel3')];
    const stopButtons = [document.getElementById('stop1'), document.getElementById('stop2'), document.getElementById('stop3')];
    const coinCountSpan = document.getElementById('coin-count');
    const betAmountInput = document.getElementById('bet-amount');
    const spinButton = document.getElementById('spin-button');
    const messageDiv = document.getElementById('message');

    // --- ã‚²ãƒ¼ãƒ ã®åŸºæœ¬è¨­å®š ---
    const symbols = [
        { name: 's7', content: 'ï¼—', payout: 100 },
        { name: 'bell', content: 'ğŸ””', payout: 50 },
        { name: 'melon', content: 'ğŸ‰', payout: 20 },
        { name: 'cherry', content: 'ğŸ’', payout: 10, }
    ];

    // --- ã‚²ãƒ¼ãƒ ã®çŠ¶æ…‹ç®¡ç† ---
    let coins = 100;
    let reelSpins = [null, null, null]; // å„ãƒªãƒ¼ãƒ«ã®setIntervalã‚’ç®¡ç†
    let stoppedReels = 0; // åœæ­¢ã—ãŸãƒªãƒ¼ãƒ«ã®æ•°

    // --- åˆæœŸåŒ–å‡¦ç† ---
    function initialize() {
        spinButton.addEventListener('click', spin);
        stopButtons.forEach((button, index) => {
            button.addEventListener('click', () => stopReel(index));
        });
        // åˆæœŸãƒªãƒ¼ãƒ«è¡¨ç¤º
        reels.forEach(reel => drawReelContent(reel, symbols.find(s => s.name === 'cherry')));
    }
    
    // --- é–¢æ•°å®šç¾© ---

    // ãƒªãƒ¼ãƒ«ã®è¡¨ç¤ºå†…å®¹ã‚’æç”»ã™ã‚‹ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°
    function drawReelContent(reelElement, symbol) {
        reelElement.dataset.symbolName = symbol.name;
        reelElement.textContent = symbol.content;
    }

    // ã‚¹ãƒ”ãƒ³ãƒœã‚¿ãƒ³ãŒæŠ¼ã•ã‚ŒãŸã¨ãã®å‡¦ç†
    function spin() {
        if (reelSpins.some(s => s !== null)) return; // å›è»¢ä¸­ã¯ç„¡è¦–

        const betAmount = parseInt(betAmountInput.value);
        if (isNaN(betAmount) || betAmount <= 0) {
            showMessage("æœ‰åŠ¹ãªãƒ™ãƒƒãƒˆé¡ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚"); return;
        }
        if (coins < betAmount) {
            showMessage("ã‚³ã‚¤ãƒ³ãŒè¶³ã‚Šã¾ã›ã‚“ï¼"); return;
        }
        
        // UIã®çŠ¶æ…‹ã‚’æ›´æ–°
        spinButton.disabled = true;
        betAmountInput.disabled = true;
        stopButtons.forEach(button => button.disabled = false);
        showMessage("ãƒªãƒ¼ãƒ«ã‚’æ­¢ã‚ã¦ãã ã•ã„ï¼");
        stoppedReels = 0;

        // ã‚³ã‚¤ãƒ³ã‚’æ¶ˆè²»
        coins -= betAmount;
        updateCoins();

        // å…¨ã¦ã®ãƒªãƒ¼ãƒ«ã‚’å›è»¢é–‹å§‹
        reels.forEach((reel, index) => {
            reelSpins[index] = setInterval(() => {
                const randomSymbol = symbols[Math.floor(Math.random() * symbols.length)];
                drawReelContent(reel, randomSymbol);
            }, 80); // å›è»¢é€Ÿåº¦
        });
    }

    // ãƒªãƒ¼ãƒ«ã‚’åœæ­¢ã•ã›ã‚‹å‡¦ç†
    function stopReel(index) {
        if (reelSpins[index] === null) return; // ã™ã§ã«æ­¢ã¾ã£ã¦ã„ã‚‹ãƒªãƒ¼ãƒ«ã¯ç„¡è¦–

        clearInterval(reelSpins[index]);
        reelSpins[index] = null;
        stopButtons[index].disabled = true;
        stoppedReels++;

        // å…¨ã¦ã®ãƒªãƒ¼ãƒ«ãŒåœæ­¢ã—ãŸã‚‰çµæœã‚’åˆ¤å®š
        if (stoppedReels === 3) {
            checkWin();
        }
    }

    // å½“ãŸã‚Šåˆ¤å®šã¨é…å½“ã®å‡¦ç†
    function checkWin() {
        const resultSymbols = reels.map(reel => reel.dataset.symbolName);
        const [r1, r2, r3] = resultSymbols;
        const betAmount = parseInt(betAmountInput.value);

        let winAmount = 0;
        let winMessage = "æ®‹å¿µï¼";

        // 3ã¤æƒã„ã®åˆ¤å®š
        if (r1 === r2 && r2 === r3) {
            const symbol = symbols.find(s => s.name === r1);
            winAmount = betAmount * symbol.payout;
            winMessage = `ğŸ‰ ${symbol.content}ãŒæƒã£ãŸï¼ ${winAmount}ã‚³ã‚¤ãƒ³ç²å¾—ï¼ ğŸ‰`;
        } else {
            // ãƒã‚§ãƒªãƒ¼å½¹ã®åˆ¤å®š
            const cherrySymbol = symbols.find(s => s.name === 'cherry');
            const cherryCount = resultSymbols.filter(s => s === 'cherry').length;
            if (cherryCount === 2) {
                winAmount = betAmount * cherrySymbol.doublePayout;
                winMessage = `ğŸ’ ãƒã‚§ãƒªãƒ¼ãŒ2ã¤ï¼ ${winAmount}ã‚³ã‚¤ãƒ³ç²å¾—ï¼`;
            } else if (cherryCount === 1) {
                winAmount = betAmount * cherrySymbol.singlePayout;
                winMessage = `ğŸ’ ãƒã‚§ãƒªãƒ¼ãŒ1ã¤ï¼ ${winAmount}ã‚³ã‚¤ãƒ³ç²å¾—ï¼`;
            }
        }
        
        if (winAmount > 0) {
            coins += winAmount;
            updateCoins();
        }
        
        showMessage(winMessage);
        
        // ã‚²ãƒ¼ãƒ çµ‚äº†å¾Œã®UIãƒªã‚»ãƒƒãƒˆ
        if (coins > 0) {
            spinButton.disabled = false;
            betAmountInput.disabled = false;
        } else {
            showMessage("ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ï¼ãƒªãƒ­ãƒ¼ãƒ‰ã—ã¦å†æŒ‘æˆ¦ï¼");
            spinButton.disabled = true;
        }
    }

    function updateCoins() { coinCountSpan.textContent = coins; }
    function showMessage(text) { messageDiv.textContent = text; }
    
    // --- å®Ÿè¡Œ ---
    initialize();

</script>

</body>
</html>
